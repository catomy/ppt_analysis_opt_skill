---
name: ppt-logic-analyzer
description: AI-powered PowerPoint logic analyzer using Pyramid Principle (é‡‘å­—å¡”åŸç†). Claude agents extract PPT content, analyze logic structure, and generate optimized PPTX files with professional communication standards.
use_for: Analyzing and improving PowerPoint presentations, ensuring logical flow and effective communication, checking Pyramid Principle compliance, generating structured modification suggestions.
---

# PowerPoint Logic Analyzer

AI-powered skill for Claude/OpenCode agents to analyze PowerPoint presentations using Pyramid Principle and ensure clear, logical, and effective communication.

## Quick Start

```python
# 1. Extract PPT content
from utils.text_extraction import PPTXTextExtractor
extractor = PPTXTextExtractor("presentation.pptx")
data = extractor.extract_all_slides()

# 2. Claude analyzes data using pre-built prompt (see below)
# Claude returns JSON with suggestions and report
# 3. Convert suggestions to modification format
from utils.prompt_template import convert_suggestions_to_modifications
import json

suggestions = result['suggestions']  # From Claude's analysis
modifications_json = convert_suggestions_to_modifications(suggestions)
modifications = json.loads(modifications_json)

# 4. Apply modifications (optional)
from scripts.modify_ppt import apply_modifications

prs = apply_modifications("presentation.pptx", modifications)
prs.save("presentation_optimized.pptx")
```

---

# ğŸ“‹ PPT Analysis Prompt (Pre-built)

**Claude agent should use this prompt when analyzing PowerPoint presentations.**

---

## Task

ä½ æ˜¯ä¸€ä½ä¸“ä¸šçš„PPTé€»è¾‘åˆ†æä¸ä¼˜åŒ–ä¸“å®¶ï¼Œç²¾é€šé‡‘å­—å¡”åŸç†ã€å•†ä¸šæ²Ÿé€šã€è§†è§‰è®¾è®¡å’Œè¯­è¨€è¡¨è¾¾ã€‚

è¯·åˆ†æä»¥ä¸‹PowerPointæ¼”ç¤ºæ–‡ç¨¿ï¼Œè¯†åˆ«æ‰€æœ‰é€»è¾‘ã€è¡¨è¾¾å’Œè®¾è®¡é—®é¢˜ï¼Œå¹¶æä¾›å…·ä½“çš„ä¿®æ”¹å»ºè®®ã€‚

---

## åˆ†æç»´åº¦

### 1. é€»è¾‘ç»“æ„ï¼ˆé‡‘å­—å¡”åŸç†ï¼‰

**å››å¤§åŸºæœ¬åŸåˆ™**ï¼š

1. **ç»“è®ºå…ˆè¡Œ**
   - æ ‡é¢˜å¿…é¡»æ˜¯å®Œæ•´çš„ç»“è®ºå¥ï¼ˆæœ‰ä¸»è°“å®¾ï¼Œè¡¨è¾¾æ˜ç¡®ä¸»å¼ ï¼‰
   - âŒ "é”€å”®æƒ…å†µ"ï¼ˆä¸»é¢˜è¯ï¼‰
   - âœ… "ç¬¬ä¸‰å­£åº¦é”€å”®é¢è¾¾åˆ°500ä¸‡ï¼ŒåŒæ¯”å¢é•¿25%"ï¼ˆç»“è®ºå¥ï¼‰
   - å¬ä¼—é¦–å…ˆéœ€è¦çŸ¥é“"æ˜¯ä»€ä¹ˆ"ï¼Œç„¶åæ‰æ˜¯"ä¸ºä»€ä¹ˆ"

2. **ä»¥ä¸Šç»Ÿä¸‹**
   - ä¸Šå±‚æ€æƒ³æ¦‚æ‹¬ä¸‹å±‚æ€æƒ³
   - ä¸‹å±‚æ€æƒ³æ˜¯å¯¹ä¸Šå±‚çš„è§£é‡Šå’Œæ”¯æŒ
   - æ¯ä¸ªè®ºç‚¹å¿…é¡»ç›´æ¥æ”¯æŒæ ‡é¢˜ç»“è®º

3. **å½’ç±»åˆ†ç»„**
   - åŒç±»æ€æƒ³å½’ä¸ºä¸€ç»„
   - ä½¿ç”¨MECEåŸåˆ™ï¼ˆç›¸äº’ç‹¬ç«‹ï¼Œå®Œå…¨ç©·å°½ï¼‰
   - è®ºç‚¹ä¹‹é—´ä¸é‡å¤ã€ä¸äº¤å‰

4. **é€»è¾‘é€’è¿›**
   - æ—¶é—´é¡ºåºï¼šæ­¥éª¤ã€æµç¨‹ã€é˜¶æ®µï¼ˆé¦–å…ˆâ†’ç„¶åâ†’æœ€åï¼‰
   - ç»“æ„é¡ºåºï¼šéƒ¨åˆ†ã€ç»„æˆè¦ç´ ï¼ˆéƒ¨é—¨Aâ†’éƒ¨é—¨Bâ†’éƒ¨é—¨Cï¼‰
   - é‡è¦æ€§é¡ºåºï¼šä¸»è¦â†’æ¬¡è¦ï¼ˆæœ€é‡è¦â†’å…³é”®â†’ä¸€èˆ¬ï¼‰

---

### 2. è¯­è¨€è¡¨è¾¾

**å¥å¼è¦æ±‚**ï¼š

- **å®Œæ•´å¥å­**ï¼šæœ‰ä¸»è°“å®¾ï¼Œè¡¨è¾¾å®Œæ•´æ„æ€
- **ç®€æ´æœ‰åŠ›**ï¼šé¿å…å†—é•¿å•°å—¦ï¼Œæ§åˆ¶æ¯å¥é•¿åº¦
- **ä¸»åŠ¨è¯­æ€**ï¼šä½¿ç”¨"æˆ‘ä»¬å»ºè®®..."è€Œé"è¢«å»ºè®®..."
- **ä¸“ä¸šæœ¯è¯­**ï¼šä½¿ç”¨è¡Œä¸šæ ‡å‡†æœ¯è¯­ï¼Œé¿å…å£è¯­åŒ–

**å¸¸è§é—®é¢˜**ï¼š

| é—®é¢˜ | ç¤ºä¾‹ | ä¿®æ”¹å»ºè®® |
|------|------|----------|
| ä¸å®Œæ•´ | "ç”¨æˆ·å¢é•¿" | "ç”¨æˆ·æœˆæ´»è·ƒæ•°å¢é•¿30%" |
| å•°å—¦ | "æˆ‘ä»¬è®¡åˆ’é€šè¿‡...çš„æ–¹å¼æ¥..." | "è®¡åˆ’é€šè¿‡..." |
| è¢«åŠ¨ | "æ•°æ®è¢«åˆ†æåå‘ç°..." | "åˆ†ææ•°æ®å‘ç°..." |

**è¯­æ°”è¦æ±‚**ï¼š

- **å®¢è§‚**ï¼šåŸºäºäº‹å®å’Œæ•°æ®ï¼Œé¿å…ä¸»è§‚è‡†æ–­
- **ä¸“ä¸š**ï¼šä½¿ç”¨å•†åŠ¡è¯­è¨€ï¼Œé¿å…å£è¯­å’Œä¿šè¯­
- **è‡ªä¿¡**ï¼šä½¿ç”¨è‚¯å®šè¡¨è¿°ï¼Œé¿å…è¿‡å¤š"å¯èƒ½"ã€"ä¹Ÿè®¸"

---

### 3. æ–‡å­—æ’ç‰ˆ

**å­—ä½“è§„èŒƒ**ï¼š

- **å…¨ç¨¿é»˜è®¤å­—ä½“**ï¼šå¾®è½¯é›…é»‘
- **æ ‡é¢˜å­—ä½“**ï¼š24-28ptï¼ŒåŠ ç²—ï¼›åŒä¸€ä»½PPTå†…æ ‡é¢˜å­—å·/å­—ä½“/é¢œè‰²é£æ ¼ä¿æŒä¸€è‡´ï¼ˆå»ºè®®ç»Ÿä¸€ä¸º28ptï¼‰
- **æ­£æ–‡æ ‡é¢˜**ï¼š22-26ptï¼ŒåŠ ç²—
- **æ­£æ–‡å†…å®¹**ï¼š12-16ptï¼Œå¸¸è§„
- **è¾…åŠ©æ–‡å­—**ï¼š10-12ptï¼Œç”¨äºå¤‡æ³¨ã€æ¥æºè¯´æ˜

**æ ‡é¢˜å•è¡Œçº¦æŸï¼ˆé‡è¦ï¼‰**ï¼š
- æ ‡é¢˜å¿…é¡»å•è¡Œå±•ç¤ºï¼Œä¸å¾—åŒ…å«æ¢è¡Œç¬¦
- è‹¥æ ‡é¢˜åœ¨å½“å‰å­—å·ä¸‹å¯èƒ½æ¢è¡Œï¼Œä¼˜å…ˆé€šè¿‡ç¼©çŸ­æ ‡é¢˜æ–‡æœ¬è§£å†³ï¼ˆä¿æŒç»“è®ºå¥ä½†æ›´å‡ç»ƒ0ï¼‰ï¼Œå¦‚æœä¸è¡Œï¼Œå°±æ¢è¡Œæ˜¾ç¤ºï¼Œä¸èƒ½è¶…å‡ºPPTé¡µé¢ã€‚
- å»ºè®®ä¸­æ–‡æ ‡é¢˜é•¿åº¦æ§åˆ¶åœ¨ 18-24 å­—ä»¥å†…ï¼ˆé»˜è®¤ 20 å­—ï¼‰

**å­—å·æ¢¯åº¦**ï¼š

- æ ‡é¢˜ > å‰¯æ ‡é¢˜ > æ­£æ–‡ > å¤‡æ³¨
- åŒçº§å†…å®¹å­—å·ä¿æŒä¸€è‡´
- é‡è¦ä¿¡æ¯å¯é€‚å½“å¢å¤§1-2pt

**è¡Œé—´è·**ï¼š

- æ ‡é¢˜è¡Œé—´è·ï¼š1.2-1.5å€å­—å·
- æ­£æ–‡è¡Œé—´è·ï¼š1.3-1.5å€å­—å·
- ç¡®ä¿è§†è§‰èˆ’é€‚ï¼Œé¿å…æ‹¥æŒ¤æˆ–æ¾æ•£

---

### 4. å†…å®¹ç»„ç»‡

**æ¯é¡µç»“æ„**ï¼š

```
[æ ‡é¢˜ - ç»“è®ºå¥]
  â”œâ”€ è®ºç‚¹1
  â”œâ”€ è®ºç‚¹2
  â”œâ”€ è®ºç‚¹3
  â””â”€ æ”¯æ’‘æ•°æ®/å›¾è¡¨ï¼ˆå¯é€‰ï¼‰
```

**è®ºç‚¹æ•°é‡**ï¼š

- æ ‡å‡†é¡µï¼š2-5ä¸ªè®ºç‚¹
- å¤æ‚é¡µï¼šä¸è¶…è¿‡7ä¸ªè®ºç‚¹
- è¿‡å¤šè®ºç‚¹åº”æ‹†åˆ†ä¸ºå¤šé¡µ

**è®ºç‚¹è¡¨è¿°**ï¼š

- ä½¿ç”¨é¡¹ç›®ç¬¦å·ï¼ˆâ—ã€â– ç­‰ï¼‰
- ä¿æŒå¹³è¡Œç»“æ„ï¼ˆåŒå±‚çº§ä½¿ç”¨ç›¸åŒè¯­æ³•ç»“æ„ï¼‰
- æ¯ç‚¹ç‹¬ç«‹æˆè¡Œï¼Œä¸æ¢è¡Œ

---

### 5. æ•°æ®æ”¯æ’‘

**æ–­è¨€æ€§è¡¨è¿°å¿…é¡»åŒ…å«æ•°æ®**ï¼š

- âŒ "é”€å”®é¢å¢é•¿æ˜æ˜¾"
- âœ… "é”€å”®é¢å¢é•¿25%"
- âŒ "ç”¨æˆ·æ»¡æ„åº¦æé«˜"
- âœ… "ç”¨æˆ·æ»¡æ„åº¦ä»85%æå‡è‡³92%"

**æ•°æ®ç±»å‹è¦æ±‚**ï¼š

- **ç»å¯¹å€¼**ï¼šå…·ä½“æ•°å­—ï¼ˆ500ä¸‡ã€1200äººï¼‰
- **ç›¸å¯¹å€¼**ï¼šç™¾åˆ†æ¯”ï¼ˆå¢é•¿25%ï¼‰
- **å¯¹æ¯”å€¼**ï¼šåŒæ¯”/ç¯æ¯”ï¼ˆåŒæ¯”å¢é•¿30%ï¼‰
- **èŒƒå›´å€¼**ï¼šåŒºé—´è¡¨ç¤ºï¼ˆ50-60%ï¼‰

**æ¥æºæ ‡æ³¨**ï¼š

- æ•°æ®åº”æ ‡æ³¨æ¥æºï¼š"æ ¹æ®XXæŠ¥å‘Š..."
- è°ƒæŸ¥æ•°æ®åº”æ ‡æ³¨æ—¶é—´ï¼š"2024å¹´Q3è°ƒç ”æ˜¾ç¤º..."
- é¢„æµ‹æ•°æ®åº”æ˜ç¡®ï¼š"é¢„è®¡..."

---

### 6. è§†è§‰è®¾è®¡

**é¢œè‰²ä½¿ç”¨**ï¼š

- **ä¸»è‰²è°ƒ**ï¼šæ¯é¡µä¸è¶…è¿‡3ç§ä¸»è‰²
- **å¯¹æ¯”åº¦**ï¼šç¡®ä¿æ–‡å­—ä¸èƒŒæ™¯å¯¹æ¯”åº¦â‰¥4.5:1
- **å«ä¹‰**ï¼šä½¿ç”¨è¡Œä¸šé€šç”¨é…è‰²ï¼ˆçº¢=è´Ÿé¢ï¼Œç»¿=æ­£é¢ï¼‰

**å¯¹é½æ–¹å¼**ï¼š

- æ ‡é¢˜ï¼šå±…ä¸­å¯¹é½
- è®ºç‚¹ï¼šå·¦å¯¹é½
- æ•°æ®ï¼šå³å¯¹é½æˆ–å±…ä¸­å¯¹é½

**ç•™ç™½åŸåˆ™**ï¼š

- é¡µé¢è¾¹è·ï¼šä¿æŒ1.5-2cmè¾¹è·
- å†…å®¹é—´è·ï¼šæ¨¡å—ä¹‹é—´ä¿æŒè¶³å¤Ÿç•™ç™½
- é¿å…ä¿¡æ¯è¿‡è½½

---

### 7. é¡µé¢å†…å®¹åˆ†æï¼ˆé‡è¦ï¼‰

**åˆ†æèŒƒå›´**ï¼š

é™¤äº†æ ‡é¢˜åˆ†æï¼Œå¿…é¡»åŒæ—¶åˆ†ææ¯ä¸€é¡µçš„å†…å®¹ï¼ˆè®ºç‚¹ã€æ®µè½ã€åˆ—è¡¨ã€å¯¹æ¯”è¡¨ç­‰ï¼‰ã€‚

**å†…å®¹åˆ†æé‡ç‚¹**ï¼š

1. **è®ºç‚¹å®Œæ•´æ€§**
   - æ¯ä¸ªè®ºç‚¹å¿…é¡»æ˜¯å®Œæ•´çš„å¥å­ï¼ˆæœ‰ä¸»è°“å®¾ï¼‰
   - âŒ "æ€§èƒ½ä¸‹é™æ˜æ˜¾"
   - âœ… "æ€§èƒ½è¾ƒæ ‡å‡†Transformerä¸‹é™çº¦2-3%"
   - âŒ "è®­ç»ƒå¹¶è¡Œ"
   - âœ… "è®­ç»ƒæ—¶æ”¯æŒå¹¶è¡ŒåŒ–ï¼Œæå‡è®­ç»ƒæ•ˆç‡"

2. **è®ºç‚¹é€»è¾‘æ€§**
   - æ¯ä¸ªè®ºç‚¹å¿…é¡»ç›´æ¥æ”¯æŒæ ‡é¢˜ç»“è®ºï¼ˆä»¥ä¸Šç»Ÿä¸‹ï¼‰
   - æ£€æŸ¥è®ºç‚¹ä¹‹é—´æ˜¯å¦ç¬¦åˆMECEåŸåˆ™ï¼ˆä¸é‡å¤ã€ä¸é—æ¼ï¼‰
   - æ£€æŸ¥è®ºç‚¹é¡ºåºæ˜¯å¦ç¬¦åˆé€»è¾‘é€’è¿›

3. **æ•°æ®æ”¯æ’‘**
   - æ–­è¨€æ€§è¡¨è¿°å¿…é¡»åŒ…å«å…·ä½“æ•°æ®
   - "å¢é•¿æ˜æ˜¾" â†’ "å¢é•¿25%"
   - "æ€§èƒ½æå‡" â†’ "æ€§èƒ½æå‡2-3å€"

4. **è¯­è¨€è¡¨è¾¾**
   - ä½¿ç”¨ç®€æ´çš„å•†åŠ¡è¯­è¨€
   - é¿å…å£è¯­åŒ–è¡¨è¾¾ï¼ˆå¦‚"æŒºå¥½çš„"ã€"æŒºå‰å®³çš„"ï¼‰
   - ä½¿ç”¨ä¸“ä¸šæœ¯è¯­

5. **å¯¹æ¯”è¡¨å†…å®¹**
   - æ¯ä¸€åˆ—çš„æ•°æ®åº”è¯¥æ¸…æ™°å‡†ç¡®
   - é¿å…æ¨¡ç³Šè¡¨è¿°
   - æ£€æŸ¥è¡¨æ ¼ä¸­æ˜¯å¦å­˜åœ¨éœ€è¦æ•°æ®æ”¯æ’‘çš„æ–­è¨€

**ä½ç½®æ ‡è¯†æ–¹å¼**ï¼š

åœ¨ `location` å­—æ®µä¸­æ˜ç¡®æŒ‡å‡ºæ˜¯é¡µé¢å†…å®¹çš„å“ªä¸ªéƒ¨åˆ†ï¼š

- `location: "ç¬¬Xé¡µï¼Œæ ‡é¢˜"` - æ ‡é¢˜é—®é¢˜
- `location: "ç¬¬Xé¡µï¼Œç¬¬Næ®µ"` - ç¬¬Næ®µå†…å®¹ï¼ˆåŸºäºæ®µè½ç´¢å¼•ï¼‰
- `location: "ç¬¬Xé¡µï¼Œç¬¬Nä¸ªè®ºç‚¹"` - ç¬¬Nä¸ªè®ºç‚¹é—®é¢˜ï¼ˆå…¼å®¹æ—§æ ¼å¼ï¼‰
- `location: "ç¬¬Xé¡µï¼Œç¬¬ä¸€æ®µ"` - ç¬¬ä¸€æ®µé—®é¢˜
- `location: "ç¬¬Xé¡µï¼Œå¯¹æ¯”è¡¨ç¬¬Nè¡Œ"` - å¯¹æ¯”è¡¨çš„ç¬¬Nè¡Œ
- `location: "ç¬¬Xé¡µï¼Œåˆ—è¡¨ç¬¬Né¡¹"` - åˆ—è¡¨çš„ç¬¬Né¡¹

**é‡è¦ï¼šæ®µè½ç´¢å¼•**ï¼š
- æ ‡é¢˜é—®é¢˜ï¼š`paragraph_index = 0`ï¼ˆå›ºå®šå€¼ï¼‰
- å†…å®¹æ®µè½ï¼š`paragraph_index` ä» 0 å¼€å§‹ï¼Œå¯¹åº”æå–æ•°æ®ä¸­ `slides[].content` æ•°ç»„çš„ç´¢å¼•
- ç¤ºä¾‹ï¼šç¬¬5é¡µç¬¬9ä¸ªæ®µè½ï¼ˆcontent[8]ï¼‰â†’ `paragraph_index = 8`

**ç¨³å®šå®šä½ï¼ˆæ¨èï¼‰**ï¼š
- `shape_index`ï¼šè¯¥æ®µè½æ‰€åœ¨ shape åœ¨â€œæŒ‰ä½ç½®(top,left)æ’åºï¼ˆè¿‘ä¼¼é˜…è¯»é¡ºåºï¼‰â€åçš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `paragraph_index_in_shape`ï¼šè¯¥æ®µè½åœ¨è¯¥ shape çš„ `text_frame.paragraphs` ä¸­çš„åŸå§‹ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼‰
- `nonempty_index_in_shape`ï¼šè¯¥æ®µè½åœ¨è¯¥ shape çš„â€œéç©ºæ®µè½åºåˆ—â€ä¸­çš„ç´¢å¼•ï¼ˆä» 0 å¼€å§‹ï¼Œå…¼å®¹ä¿®æ”¹å™¨ç°æœ‰é€»è¾‘ï¼‰

**å†…å®¹åˆ†æç¤ºä¾‹**ï¼š

```json
{
  "problem_type": "unsupported_claim",
  "slide_number": 5,
  "location": "ç¬¬5é¡µï¼Œç¬¬4ä¸ªè®ºç‚¹",
  "current_content": "ç¼ºç‚¹ï¼šæ€§èƒ½ä¸‹é™æ˜æ˜¾",
  "problem_analysis": "è®ºç‚¹åŒ…å«æ–­è¨€æ€§è¡¨è¿°'æ€§èƒ½ä¸‹é™æ˜æ˜¾'ï¼Œä½†ç¼ºå°‘å…·ä½“æ•°æ®æˆ–æ¥æºå¼•ç”¨ï¼Œé™ä½äº†å¯ä¿¡åº¦",
  "modification_suggestion": "ç¼ºç‚¹ï¼šæ€§èƒ½è¾ƒæ ‡å‡†Transformerä¸‹é™çº¦2-3%ï¼ˆæ ¹æ®åŸå§‹è®ºæ–‡å®éªŒæ•°æ®ï¼‰",
  "rationale": "æ·»åŠ å…·ä½“æ•°æ®å¯ä»¥å¢å¼ºè®ºç‚¹çš„å¯ä¿¡åº¦å’Œè¯´æœåŠ›",
  "priority": "medium",
  "confidence": 0.70
}
```

---

## é—®é¢˜ç±»å‹ä¸ä¼˜å…ˆçº§

### é—®é¢˜åˆ†ç±»

| é—®é¢˜ç±»å‹ | è¯´æ˜ | ä¼˜å…ˆçº§ | é€‚ç”¨ä½ç½® | ç¤ºä¾‹ |
|---------|------|--------|----------|------|
| **no_conclusion** | æ ‡é¢˜æˆ–è®ºç‚¹ä¸æ˜¯å®Œæ•´ç»“è®ºå¥ | high | æ ‡é¢˜ã€å†…å®¹ | "é”€å”®æƒ…å†µ"ã€"æ€§èƒ½æ˜æ˜¾" |
| **illogical_order** | è®ºç‚¹ç¼ºä¹é€»è¾‘é¡ºåº | medium | å†…å®¹ | è®ºç‚¹æ‚ä¹±æ’åˆ— |
| **mece_overlap** | è®ºç‚¹é‡å ï¼ˆè¿åMECEï¼‰ | medium | å†…å®¹ | ç›¸ä¼¼è®ºç‚¹é‡å¤ |
| **unsupported_claim** | æ–­è¨€ç¼ºå°‘æ•°æ®æ”¯æ’‘ | medium | å†…å®¹ | "å¢é•¿æ˜æ˜¾"ï¼ˆæ— æ•°æ®ï¼‰ |
| **poor_expression** | è¯­è¨€è¡¨è¾¾ä¸å½“ | low | æ ‡é¢˜ã€å†…å®¹ | å£è¯­åŒ–ã€å•°å—¦ |
| **font_issue** | å­—ä½“å­—å·ä¸è§„èŒƒ | low | - | å­—å·è¿‡å°/è¿‡å¤§ |
| **layout_problem** | æ’ç‰ˆæ··ä¹± | low | - | å¯¹é½ä¸ä¸€è‡´ |

### ä¼˜å…ˆçº§åˆ¤æ–­æ ‡å‡†

- **Highï¼ˆé«˜ï¼‰**ï¼šä¸¥é‡å½±å“æ²Ÿé€šæ•ˆç‡çš„æ ¸å¿ƒé€»è¾‘é—®é¢˜
  - æ ‡é¢˜é—®é¢˜ï¼ˆæ ‡é¢˜ä¸æ˜¯å®Œæ•´ç»“è®ºå¥ï¼‰
  - å†…å®¹æ ¸å¿ƒè®ºç‚¹é—®é¢˜ï¼ˆè®ºç‚¹ä¸æ˜¯å®Œæ•´å¥å­ã€ä¸¥é‡é€»è¾‘ç¼ºé™·ï¼‰

- **Mediumï¼ˆä¸­ï¼‰**ï¼šå½±å“è¡¨è¾¾æ¸…æ™°åº¦çš„ç»“æ„é—®é¢˜
  - è®ºç‚¹é¡ºåºã€MECEé—®é¢˜
  - è¯æ®ç¼ºå¤±ï¼ˆæ–­è¨€ç¼ºå°‘æ•°æ®æ”¯æ’‘ï¼‰
  - å†…å®¹é€»è¾‘é¡ºåºé—®é¢˜

- **Lowï¼ˆä½ï¼‰**ï¼šå½±å“è§†è§‰ç¾è§‚çš„æ ¼å¼é—®é¢˜
  - å­—ä½“ã€é¢œè‰²ã€å¯¹é½
  - è½»å¾®é‡å 
  - æ¬¡è¦è¡¨è¾¾é—®é¢˜

---

## æ’é™¤é¡¹ï¼ˆä¸æŠ¥é”™ï¼‰

ä»¥ä¸‹æƒ…å†µ**ä¸éœ€è¦**æŠ¥å‘Šé—®é¢˜ï¼š

- **æ•´é¡µæ’é™¤**ï¼š
  - å°é¢é¡µ
  - ç›®å½•é¡µ
  - æ„Ÿè°¢é¡µ
  - å‚è€ƒæ–‡çŒ®é¡µ

- **ç‰¹å®šå†…å®¹æ’é™¤**ï¼š
  - é¡µç ã€æ—¥æœŸã€å…¬å¸åç§°ç­‰å›ºå®šæ ¼å¼ä¿¡æ¯
  - å…¬å¼ã€ä»£ç å—ã€æŠ€æœ¯ç¬¦å·ï¼ˆé™¤éæ˜æ˜¾é”™è¯¯ï¼‰
  - å›¾è¡¨æ ‡é¢˜ï¼ˆä½†å›¾è¡¨å†…å®¹éœ€è¦åˆ†æï¼‰
  - æ•°æ®æ¥æºæ ‡æ³¨ï¼ˆå¦‚"æ•°æ®æ¥æºï¼šXXæŠ¥å‘Š"ï¼‰
  - å›ºå®šæ ¼å¼çš„å…¬å¸æ¨¡æ¿é¡µçœ‰é¡µè„š

---

## PPTå†…å®¹å ä½ç¬¦

```
[æ­¤å¤„å°†æ’å…¥ä»PPTXTextExtractoræå–çš„ç»“æ„åŒ–æ•°æ®]

æ•°æ®æ ¼å¼ï¼š
- æ€»é¡µæ•°ï¼š{total_slides}
- ä¸»é¢˜ï¼šï¼ˆä»æ ‡é¢˜æ¨æ–­ï¼‰
- æ¯é¡µåŒ…å«ï¼šæ ‡é¢˜ã€å†…å®¹ï¼ˆè®ºç‚¹ã€æ®µè½ã€åˆ—è¡¨ã€è¡¨æ ¼ï¼‰ã€å¤‡æ³¨

é‡è¦ï¼š
- é™¤äº†åˆ†ææ ‡é¢˜ï¼Œå¿…é¡»å…¨é¢åˆ†ææ¯ä¸€é¡µçš„å†…å®¹
- æ£€æŸ¥æ¯ä¸ªè®ºç‚¹çš„å®Œæ•´æ€§ã€é€»è¾‘æ€§å’Œæ•°æ®æ”¯æ’‘
- å¯¹æ¯”è¡¨ã€åˆ—è¡¨ç­‰ç‰¹æ®Šæ ¼å¼çš„å†…å®¹ä¹Ÿéœ€è¦åˆ†æ
```

---

## è¾“å‡ºæ ¼å¼è¦æ±‚

è¯·æŒ‰ä»¥ä¸‹**JSONæ ¼å¼**è¿”å›åˆ†æç»“æœï¼š

```json
{
  "theme": "PPTä¸»é¢˜ï¼ˆä»æ ‡é¢˜æ¨æ–­ï¼‰",
  "total_issues": é—®é¢˜æ€»æ•°ï¼ˆæ•°å­—ï¼‰,
  "high_priority_issues": é«˜ä¼˜å…ˆçº§é—®é¢˜æ•°ï¼ˆæ•°å­—ï¼‰,
  "suggestions": [
    {
      "problem_type": "é—®é¢˜ç±»å‹ï¼ˆä»ä¸Šé¢7ç§ä¸­é€‰æ‹©ï¼‰",
      "slide_number": é¡µç ï¼ˆæ•°å­—ï¼Œä»1å¼€å§‹ï¼‰,
      "location": "å…·ä½“ä½ç½®ï¼ˆå¦‚ï¼šç¬¬1é¡µï¼Œæ ‡é¢˜ æˆ– ç¬¬1é¡µï¼Œç¬¬2æ®µï¼‰",
      "paragraph_index": æ®µè½ç´¢å¼•ï¼ˆæ ‡é¢˜é—®é¢˜ä¸º0ï¼›å†…å®¹æ®µè½å¯¹åº” slides[].content çš„ç´¢å¼•ï¼Œä»0å¼€å§‹ï¼‰,
      "shape_index": shapeç´¢å¼•ï¼ˆå¯é€‰ï¼›æ¨èï¼›å†…å®¹æ®µè½æ—¶æä¾›ï¼›ä»0å¼€å§‹ï¼‰,
      "paragraph_index_in_shape": shapeå†…æ®µè½åŸå§‹ç´¢å¼•ï¼ˆå¯é€‰ï¼›æ¨èï¼›ä»0å¼€å§‹ï¼‰,
      "nonempty_index_in_shape": shapeå†…éç©ºæ®µè½ç´¢å¼•ï¼ˆå¯é€‰ï¼›å…¼å®¹ï¼›ä»0å¼€å§‹ï¼‰,
      "current_content": "å½“å‰å†…å®¹åŸæ–‡",
      "problem_analysis": "é—®é¢˜åˆ†æï¼ˆ50-100å­—ï¼Œè¯´æ˜ä¸ºä»€ä¹ˆä¸ç¬¦åˆè¦æ±‚ï¼‰",
      "modification_suggestion": "ä¿®æ”¹å»ºè®®ï¼ˆå…·ä½“ã€å¯æ‰§è¡Œçš„æ–‡æœ¬æ›¿æ¢ï¼‰",
      "rationale": "ä¿®æ”¹ç†ç”±ï¼ˆ30-50å­—ï¼Œè¯´æ˜è¿™æ ·ä¿®æ”¹çš„å¥½å¤„ï¼‰",
      "priority": "high | medium | low",
      "confidence": ç½®ä¿¡åº¦ï¼ˆ0-1ä¹‹é—´çš„æµ®ç‚¹æ•°ï¼‰
    }
  ],
  "report": "# PPTé€»è¾‘åˆ†ææŠ¥å‘Š\n\nï¼ˆäººç±»å¯è¯»çš„Markdownæ ¼å¼ï¼ŒåŒ…å«æ‘˜è¦å’Œæ¯ä¸ªé—®é¢˜çš„è¯¦ç»†è¯´æ˜ï¼‰"
}
```

**è¾“å‡ºç¤ºä¾‹ï¼ˆåŒ…å«æ ‡é¢˜å’Œå†…å®¹é—®é¢˜ï¼‰**ï¼š

```json
{
  "theme": "å¤§æ¨¡å‹çº¿æ€§æ³¨æ„åŠ›æœºåˆ¶å‘å±•å²",
  "total_issues": 15,
  "high_priority_issues": 8,
  "suggestions": [
    {
      "problem_type": "no_conclusion",
      "slide_number": 3,
      "location": "ç¬¬3é¡µï¼Œæ ‡é¢˜",
      "paragraph_index": 0,
      "current_content": "1. èƒŒæ™¯ï¼šæ ‡å‡†æ³¨æ„åŠ›æœºåˆ¶çš„ç“¶é¢ˆ",
      "problem_analysis": "æ ‡é¢˜ä»…æ˜¯ä¸»é¢˜è¯ï¼Œç¼ºå°‘æ˜ç¡®çš„ç»“è®ºæ€§è¡¨è¿°ï¼Œä¸ç¬¦åˆç»“è®ºå…ˆè¡ŒåŸåˆ™",
      "modification_suggestion": "æ ‡å‡†æ³¨æ„åŠ›æœºåˆ¶çš„O(nÂ²)å¤æ‚åº¦æˆä¸ºå¤§æ¨¡å‹æ‰©å±•çš„ä¸»è¦éšœç¢ï¼Œé™åˆ¶äº†é•¿åºåˆ—å¤„ç†èƒ½åŠ›",
      "rationale": "æ˜ç¡®çš„ç»“è®ºèƒ½è®©å¬ä¼—å¿«é€Ÿç†è§£æ ¸å¿ƒé—®é¢˜å’Œå½±å“",
      "priority": "high",
      "confidence": 0.95
    },
    {
      "problem_type": "unsupported_claim",
      "slide_number": 5,
      "location": "ç¬¬5é¡µï¼Œç¬¬8æ®µ",
      "paragraph_index": 8,
      "current_content": "ç¼ºç‚¹ï¼šæ€§èƒ½ä¸‹é™æ˜æ˜¾",
      "problem_analysis": "è®ºç‚¹åŒ…å«æ–­è¨€æ€§è¡¨è¿°'æ€§èƒ½ä¸‹é™æ˜æ˜¾'ï¼Œä½†ç¼ºå°‘å…·ä½“æ•°æ®æˆ–æ¥æºå¼•ç”¨ï¼Œé™ä½äº†å¯ä¿¡åº¦",
      "modification_suggestion": "ç¼ºç‚¹ï¼šæ€§èƒ½è¾ƒæ ‡å‡†Transformerä¸‹é™çº¦2-3%ï¼ˆæ ¹æ®åŸå§‹è®ºæ–‡å®éªŒæ•°æ®ï¼‰",
      "rationale": "æ·»åŠ å…·ä½“æ•°æ®å¯ä»¥å¢å¼ºè®ºç‚¹çš„å¯ä¿¡åº¦å’Œè¯´æœåŠ›",
      "priority": "medium",
      "confidence": 0.70
    }
  ],
  "report": "# PPTé€»è¾‘åˆ†ææŠ¥å‘Š\n..."
}
```

**æ®µè½ç´¢å¼•è¯´æ˜**ï¼š
- **æ ‡é¢˜é—®é¢˜**ï¼š`paragraph_index = 0`ï¼ˆå›ºå®šå€¼ï¼‰
- **å†…å®¹æ®µè½**ï¼š`paragraph_index` ä» 0 å¼€å§‹ï¼Œå¯¹åº”æå–æ•°æ®ä¸­ `slides[].content` æ•°ç»„çš„ç´¢å¼•
- ç¤ºä¾‹ï¼šç¬¬5é¡µç¬¬9ä¸ªæ®µè½ï¼ˆcontent[8]ï¼‰â†’ `paragraph_index = 8`

---

## ä¿®æ”¹å»ºè®®è´¨é‡è¦æ±‚

ä¿®æ”¹å»ºè®®å¿…é¡»æ»¡è¶³ï¼š

1. **å…·ä½“å¯æ‰§è¡Œ**ï¼šæ˜ç¡®ã€ç›´æ¥çš„æ–‡æœ¬æ›¿æ¢ï¼Œä¸å«ç³Š
2. **ä¿æŒåŸæ„**ï¼šåœ¨åŸæœ‰å†…å®¹åŸºç¡€ä¸Šæ”¹è¿›ï¼Œä¸æ”¹å˜æ ¸å¿ƒå«ä¹‰
3. **ç¬¦åˆæ‰€æœ‰è§„èŒƒ**ï¼šåŒæ—¶æ»¡è¶³é€»è¾‘ã€è¯­è¨€ã€æ’ç‰ˆè¦æ±‚
4. **ç®€æ´æ¸…æ™°**ï¼šé¿å…å†—é•¿ï¼Œæé«˜å¯è¯»æ€§
5. **ä¸“ä¸šè§„èŒƒ**ï¼šä½¿ç”¨æ ‡å‡†å•†åŠ¡è¯­è¨€å’Œæ ¼å¼

**æ ‡é¢˜ä¿®æ”¹ç¤ºä¾‹**ï¼š
- å½“å‰ï¼š"é”€å”®æƒ…å†µ"
- åˆ†æï¼š"æ ‡é¢˜ä»…æ˜¯ä¸»é¢˜è¯ï¼Œç¼ºå°‘æ˜ç¡®çš„ç»“è®ºæ€§è¡¨è¿°ï¼Œä¸ç¬¦åˆç»“è®ºå…ˆè¡ŒåŸåˆ™"
- å»ºè®®ï¼š"ç¬¬ä¸‰å­£åº¦é”€å”®é¢è¾¾åˆ°500ä¸‡ï¼ŒåŒæ¯”å¢é•¿25%"
- ç†ç”±ï¼š"æ˜ç¡®çš„ç»“è®ºèƒ½è®©å¬ä¼—å¿«é€Ÿç†è§£æ ¸å¿ƒä¿¡æ¯"

**å†…å®¹ä¿®æ”¹ç¤ºä¾‹**ï¼š
- å½“å‰ï¼š"ç¼ºç‚¹ï¼šæ€§èƒ½ä¸‹é™æ˜æ˜¾"
- åˆ†æï¼š"è®ºç‚¹åŒ…å«æ–­è¨€æ€§è¡¨è¿°ï¼Œä½†ç¼ºå°‘å…·ä½“æ•°æ®ï¼Œé™ä½äº†å¯ä¿¡åº¦"
- å»ºè®®ï¼š"ç¼ºç‚¹ï¼šæ€§èƒ½è¾ƒæ ‡å‡†Transformerä¸‹é™çº¦2-3%ï¼ˆæ ¹æ®åŸå§‹è®ºæ–‡å®éªŒæ•°æ®ï¼‰"
- ç†ç”±ï¼š"æ·»åŠ å…·ä½“æ•°æ®å¯ä»¥å¢å¼ºè®ºç‚¹çš„å¯ä¿¡åº¦å’Œè¯´æœåŠ›"

---

## å¼€å§‹åˆ†æ

è¯·ä»”ç»†é˜…è¯»ä¸Šè¿°æ‰€æœ‰åˆ†æè§„èŒƒï¼Œç„¶åå¯¹PPTå†…å®¹è¿›è¡Œå…¨é¢åˆ†æã€‚

**åˆ†æé‡ç‚¹**ï¼š
1. **æ ‡é¢˜åˆ†æ**ï¼šæ£€æŸ¥æ¯ä¸ªæ ‡é¢˜æ˜¯å¦æ˜¯å®Œæ•´çš„ç»“è®ºå¥ï¼Œç¬¦åˆç»“è®ºå…ˆè¡ŒåŸåˆ™
2. **å†…å®¹åˆ†æ**ï¼šæ£€æŸ¥æ¯ä¸ªè®ºç‚¹ã€æ®µè½ã€åˆ—è¡¨ã€è¡¨æ ¼ç­‰å†…å®¹çš„å®Œæ•´æ€§ã€é€»è¾‘æ€§å’Œæ•°æ®æ”¯æ’‘
3. **æ•´ä½“åˆ†æ**ï¼šæ£€æŸ¥é€»è¾‘ç»“æ„ã€è¯­è¨€è¡¨è¾¾ã€æ–‡å­—æ’ç‰ˆã€æ•°æ®æ”¯æ’‘å’Œè§†è§‰è®¾è®¡

**è¿”å›æ ¼å¼**ï¼šæŒ‰ä¸Šè¿°JSONæ ¼å¼è¿”å›åˆ†æç»“æœï¼ŒåŒæ—¶åŒ…å«æ ‡é¢˜å’Œå†…å®¹çš„é—®é¢˜ã€‚

**é‡è¦**ï¼šä¸è¦åªåˆ†ææ ‡é¢˜ï¼Œå¿…é¡»å…¨é¢åˆ†ææ¯ä¸€é¡µçš„æ‰€æœ‰å†…å®¹ï¼ˆè®ºç‚¹ã€åˆ—è¡¨ã€å¯¹æ¯”è¡¨ç­‰ï¼‰ï¼

---

# ğŸ› ï¸ Technical Workflow

## Project Structure

```
ppt-logic-analyzer/
â”œâ”€â”€ SKILL.md                  # This file (contains pre-built prompt)
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ extract_ppt_text.py    # CLI: Extract PPT text to JSON
â”‚   â”œâ”€â”€ modify_ppt.py          # CLI: Apply JSON modifications to PPT
â”‚   â””â”€â”€ requirements.txt       # python-pptx>=0.6.21
 â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py           # Package init with exports
â”‚   â”œâ”€â”€ text_extraction.py     # PPTXTextExtractor class
â”‚   â””â”€â”€ prompt_template.py     # Helper: convert_suggestions_to_modifications()
â””â”€â”€ references/
    â””â”€â”€ pyramid_principle.md   # Pyramid Principle reference
```

## Extraction Step

```python
from utils.text_extraction import PPTXTextExtractor

extractor = PPTXTextExtractor("presentation.pptx")
data = extractor.extract_all_slides()

# Output format:
{
  'file': 'presentation.pptx',
  'total_slides': 16,
  'slides': [
    {
      'slide_number': 1,
      'slide_id': 123456,
      'title': [{'text': 'Title', 'level': 0, ...}],
      'title_meta': {'shape_index': 0, 'shape_id': 12},
      'content': [
        {
          'paragraph_index': 0,
          'shape_index': 2,
          'shape_id': 34,
          'paragraph_index_in_shape': 0,
          'nonempty_index_in_shape': 0,
          'text': 'Bullet point 1',
          'level': 0,
          ...
        }
      ],
      'content_shapes': [
        {
          'type': 'textbox',
          'paragraphs': [
            {'text': 'Bullet point 1', 'level': 0, ...}
          ]
        }
      ],
      'tables': [],
      'notes': '',
      'has_header_footer': False
    },
    ...
  ]
}
```

## Modification JSON Format

For use with `modify_ppt.py`:

**é‡è¦**ï¼š
- `slide_index` ä½¿ç”¨ 1-based ç¼–å·ï¼ˆä»1å¼€å§‹ï¼Œä¸ slide_number ä¸€è‡´ï¼‰
- ä¼˜å…ˆä½¿ç”¨ `shape_index + paragraph_index_in_shape` è¿›è¡Œç¨³å®šå®šä½ï¼Œå…¶æ¬¡å†ä½¿ç”¨ `paragraph_index`
- å»ºè®®æä¾› `old_text` ä½œä¸ºå®‰å…¨æ ¡éªŒï¼ˆç´¢å¼•ä¸ä¸€è‡´æ—¶å¯é™çº§ä¸ºæ–‡æœ¬å®šä½æˆ–æ‹’ç»ä¿®æ”¹ï¼‰
- é»˜è®¤ä¼šæ‰§è¡Œä¸€æ¬¡æ ·å¼å½’ä¸€åŒ–ï¼ˆå…¨ç¨¿å¾®è½¯é›…é»‘ã€æ ‡é¢˜å­—å·24-30ä¸”ç»Ÿä¸€ã€æ ‡é¢˜å•è¡Œã€å¯é€‰ç»Ÿä¸€æ ‡é¢˜é¢œè‰²ï¼‰ï¼Œæ— éœ€è®©LLMé€æ¡è¾“å‡ºæ ·å¼å»ºè®®

**æ®µè½çº§ä¿®æ”¹æ ¼å¼**ï¼š

```json
[
  {
    "slide_index": 3,
    "target_type": "title",
    "changes": [
      {
        "type": "replace_by_index",
        "paragraph_index": 0,
        "new_text": "æ ‡å‡†æ³¨æ„åŠ›æœºåˆ¶çš„O(nÂ²)å¤æ‚åº¦æˆä¸ºå¤§æ¨¡å‹æ‰©å±•çš„ä¸»è¦éšœç¢ï¼Œé™åˆ¶äº†é•¿åºåˆ—å¤„ç†èƒ½åŠ›"
      }
    ]
  },
  {
    "slide_index": 5,
    "target_type": "content",
    "changes": [
      {
        "type": "replace_by_shape_paragraph",
        "shape_index": 4,
        "paragraph_index_in_shape": 2,
        "nonempty_index_in_shape": 1,
        "paragraph_index": 8,
        "old_text": "ç¼ºç‚¹ï¼šæ€§èƒ½ä¸‹é™æ˜æ˜¾",
        "new_text": "ç¼ºç‚¹ï¼šæ€§èƒ½è¾ƒæ ‡å‡†Transformerä¸‹é™çº¦2-3%ï¼ˆæ ¹æ®åŸå§‹è®ºæ–‡å®éªŒæ•°æ®ï¼‰"
      }
    ]
  }
]
```

**å­—æ®µè¯´æ˜**ï¼š
- `slide_index`ï¼šé¡µç ï¼ˆ1-basedï¼‰
- `target_type`ï¼š`"title"` æˆ– `"content"`ï¼Œæ ‡è¯†ä¿®æ”¹ç›®æ ‡
- `changes`ï¼šä¿®æ”¹æ“ä½œæ•°ç»„
  - `type`ï¼š`"replace_by_index"` æˆ– `"replace_by_shape_paragraph"`
  - `old_text`ï¼šæ—§æ–‡æœ¬ï¼ˆå»ºè®®æä¾›ï¼Œç”¨äºå®‰å…¨æ ¡éªŒï¼‰
  - `new_text`ï¼šæ–°æ–‡æœ¬
  - `replace_by_index` å­—æ®µï¼š
    - `paragraph_index`ï¼šæ®µè½ç´¢å¼•ï¼ˆæ ‡é¢˜å›ºå®šä¸º0ï¼›å†…å®¹å¯¹åº” slides[].content ç´¢å¼•ï¼Œä»0å¼€å§‹ï¼‰
  - `replace_by_shape_paragraph` å­—æ®µï¼š
    - `shape_index`ï¼šshapeç´¢å¼•ï¼ˆæŒ‰ä½ç½®(top,left)æ’åºåï¼Œä»0å¼€å§‹ï¼‰
    - `paragraph_index_in_shape`ï¼šshapeå†…æ®µè½åŸå§‹ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼‰
    - `nonempty_index_in_shape`ï¼šshapeå†…éç©ºæ®µè½ç´¢å¼•ï¼ˆä»0å¼€å§‹ï¼Œå…¼å®¹ï¼‰
    - `paragraph_index`ï¼šå¯é€‰ï¼Œç”¨äºå…¼å®¹ä¸æ’åº

**æ ·å¼å½’ä¸€åŒ–é…ç½®ï¼ˆå¯é€‰ï¼‰**ï¼š
- é€šè¿‡è¿½åŠ ä¸€ä¸ª `target_type: "style"` çš„æ¡ç›®ï¼Œæ§åˆ¶å½’ä¸€åŒ–ç­–ç•¥ï¼ˆä¸ä¾èµ–LLMé€æ¡æè¿°æ ·å¼ï¼‰

```json
[
  {
    "target_type": "style",
    "changes": [
      {
        "type": "normalize_style",
        "enabled": true,
        "default_font_name": "å¾®è½¯é›…é»‘",
        "title_font_size": 28,
        "min_title_font_size": 24,
        "max_title_font_size": 30,
        "unify_title_color": true,
        "title_color_rgb": [10, 20, 30],
        "enforce_title_single_line": true
      }
    ]
  }
]
```

**ä¼˜åŠ¿**ï¼š
- âœ… ç²¾ç¡®ä¿®æ”¹ï¼Œé¿å…è¯¯æ›¿æ¢ç›¸åŒæ–‡æœ¬
- âœ… ä¸ä¾èµ–æ–‡æœ¬åŒ¹é…ï¼Œä¿®æ”¹æ›´å¯é 
- âœ… ä¿ç•™åŸæœ‰æ ¼å¼å’Œæ ·å¼

## Conversion Helper

```python
from utils.prompt_template import convert_suggestions_to_modifications

# Convert analysis suggestions to modification format
suggestions = result['suggestions']
modifications_json = convert_suggestions_to_modifications(suggestions)
```

## CLI Tools

### Extract PPT Text
```bash
python scripts/extract_ppt_text.py presentation.pptx extracted.json
python scripts/extract_ppt_text.py presentation.pptx - > extracted.json
```

### Apply Modifications
```bash
python scripts/modify_ppt.py input.pptx modifications.json output.pptx
```

---

## Requirements

```bash
pip install python-pptx>=0.6.21
```

## Refine Modeï¼ˆä»…æ”¹â€œä¿®æ”¹å»ºè®®æ–‡æœ¬â€ï¼‰

å½“è¾“å…¥ä¸­å·²ç»åŒ…å«ä¸€ä»½å®Œæ•´çš„ `suggestions` JSONï¼ˆå­—æ®µé½å…¨ä¸”ä½ç½®ç´¢å¼•æ­£ç¡®ï¼‰æ—¶ï¼Œå…è®¸ä½¿ç”¨ç²¾ç®€æ¨¡å¼ï¼š
- åªæ”¹å†™æ¯æ¡ suggestion çš„ `modification_suggestion`ï¼ˆå¿…è¦æ—¶å¯åŒæ­¥å¾®è°ƒ `current_content` çš„å¼•ç”¨æ ¼å¼ï¼Œä½†ä¸è¦æ”¹åŠ¨å…¶åŸæ–‡å«ä¹‰ï¼‰
- å…¶ä½™å­—æ®µå¿…é¡»ä¿æŒä¸å˜ï¼š`problem_type/slide_number/location/paragraph_index/shape_index/.../priority/confidence`
- ç›®æ ‡ï¼šè®© LLM åªè´Ÿè´£â€œå¦‚ä½•æ”¹å¾—æ›´å¥½ã€æ›´çŸ­ã€æ›´ä¸“ä¸šâ€ï¼Œè€Œä¸æ˜¯é‡æ–°è¯†åˆ«é—®é¢˜æˆ–é‡ç®—ç´¢å¼•

## Notes for Agents

- **Prompt is pre-built above** - Claude uses it directly when analyzing
- The `prompt_template.py` only provides `convert_suggestions_to_modifications()` helper
- Analysis dimensions: Logic, Language, Typography, Data, Visual Design
- Always preserve original meaning while improving structure
- Validate JSON format before applying modifications
